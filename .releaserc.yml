branches: ['main']
ci: true
debug: true
tagFormat: 'v${version}'

preset: 'conventionalcommits'

analyzeCommits:
  - path: '@semantic-release/commit-analyzer'
    releaseRules:
      - breaking: true
        release: minor # Because we are in initial development
      - type: build
        release: patch
      - type: chore
        release: false
      - type: ci
        release: false
      - type: docs
        release: false
      - type: feat
        release: patch
      - type: fix
        release: patch
      - type: perf
        release: patch
      - type: refactor
        release: false
      - type: revert
        release: patch
      - type: style
        release: false
      - type: test
        release: false

generateNotes:
  - path: '@semantic-release/release-notes-generator'
    writerOpts:
      groupBy: 'type'
      commitGroupsSort: 'title'
      commitsSort: 'header'
    linkCompare: true
    linkReferences: true
    presetConfig:
      types:
        - type: 'build'
          section: 'ğŸ¦Š CI/CD'
          hidden: false
        - type: 'chore'
          section: 'Other'
          hidden: false
        - type: 'ci'
          section: 'ğŸ¦Š CI/CD'
          hidden: false
        - type: 'docs'
          section: 'ğŸ“” Docs'
          hidden: false
        - type: 'example'
          section: 'ğŸ“ Examples'
          hidden: false
        - type: 'feat'
          section: 'ğŸš€ Features'
          hidden: false
        - type: 'fix'
          section: 'ğŸ›  Fixes'
          hidden: false
        - type: 'perf'
          section: 'â© Performance'
        - type: 'refactor'
          section: ':scissors: Refactor'
          hidden: false
        - type: 'revert'
          section: 'ğŸ™…â€â™‚ï¸ Reverts'
        - type: 'style'
          section: 'ğŸ’ˆ Style'
        - type: 'test'
          section: 'ğŸ§ª Tests'
          hidden: false

prepare:
  - path: '@semantic-release/exec'
    shell: pwsh
    cmd: './Update-FunctionsToExport.ps1'
  - path: '@semantic-release/exec'
    shell: pwsh
    cmd: './Update-ModuleVersion.ps1 -Version ${nextRelease.version}'
  - path: '@semantic-release/changelog'
  - path: '@semantic-release/git'
    message: 'RELEASE: ${nextRelease.version}'
    assets: ['CHANGELOG.md', 'src/TcPrjMgmt/TcPrjMgmt.psd1']
